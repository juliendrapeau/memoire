\begin{comment}
\end{comment}


\chapter{Auto-réductibilité du circuit GM-QAOA}
\label{ann:auto-reductibilite-du-circuit-gm-qaoa}

%-----------------------------------------------------------------------------%

\begin{maintheorem}{Auto-réductibilité de GM-QAOA}{auto-reductibilite-gm-qaoa}
    Supposons qu'un circuit GM-QAOA génère efficacement des solutions approximatives à un problème auto-réductible $\varphi$ dans \textsf{\#P}. Alors, ce circuit peut être modifié, sans modifier les paramètres du circuit, pour résoudre approximativement tous les sous-problèmes $\varphi_{c}$ de $\varphi$ en conservant les propriétés de GM-QAOA.
\end{maintheorem}

\begin{proof}
    
Soit $\varphi$ une instance d'un problème de \textsf{\#P} de taille $n$ que nous voulons résoudre avec GM-QAOA. Cette instance peut être encodée dans un hamiltonien de problème $H_{P}$ avec des valeurs propres $E = 0$ pour les solutions et $E = \varepsilon_{k} > 0$ pour les non-solutions. L'opérateur $U_{P}$ correspondant avec $H_{P}$ s'écrit alors comme:

\begin{equation}
    U_{P} = \sum_{j \in G} \ket{j}\bra{j} + \sum_{k} e^{-i \gamma \varepsilon_{k}} \sum_{j \in E^{(k)}} \ket{j}\bra{j} \,,
\end{equation} 

avec $G$ et $E^{(k)}$ respectivement étant les variétés des états fondamentaux et états excités, et ainsi l'ensemble des solutions et des non-solutions de $\varphi$. Pour une espace de solutions non contraint, l'opérateur $U_{D}$ est donné par:

\begin{equation}
    U_{D}^{GM-QAOA} = \mathds{1} - (1 - e^{-i\beta}) (\ket{+}\!\bra{+}^{\otimes n}) \,.
\end{equation}

Soit $\varphi_{c}$ le sous-problème de $\varphi$ où les dernières $q$ variables sont fixées par la chaîne de bits $c$. Définissons $G_{c}$ et $E_{c}^{(k)}$ comme les ensembles de solutions and non-solutions de $\varphi_{c}$. Les états fondamentaux et excités sont écrit comme:

\begin{align}
    \ket{g_{c}} = \frac{1}{\sqrt{ \lvert G_{c} \rvert }} \sum_{j \in G_{c}} \ket{j}, \\
    \ket{e^{(k)}_{c}} = \frac{1}{\sqrt{ \lvert E^{(k)}_{c} \rvert }} \sum_{j \in E^{(k)}_{c}} \ket{j} \,.
\end{align}

Évoluons l'état initial $\ket{+}^{\otimes n}$ avec un circuit optimisé GM-QAOA de $p$ couches en séparant le registre des derniers $q$ qubits. Nous trouvons par induction que l'état final suit la formule récursive suivante:

\begin{equation}
    \label{eq:recursive-formula}
    \ket{\psi_{\varphi}} = \frac{1}{\sqrt{ N }} \sum_{i=0}^{Q-1} \left( \sqrt{ \lvert G_{i} \rvert } F_{p} \ket{g_{i}} + \sum_{k} \sqrt{ \lvert E^{(k)}_{i} \rvert } \bar{F}^{(k)}_{p} \ket{e^{(k)}_{i}} \right) \ket{i} \,,
\end{equation}

où $N=2^{n}$, $Q=2^{q}$, $F_{0}=\bar{F}_{0}^{(k)}=1$ et

\begin{align}
    F_{p} &= F_{p-1} - \frac{1}{N} (1-e^{-i\beta_{p}}) \left( \lvert G \rvert   F_{p-1} + \sum_{k'} \lvert E^{(k')} \rvert \bar{F}^{(k')}_{p-1} e^{-i\gamma_{p}\varepsilon_{k'}} \right) \,, \\
    \bar{F}^{(k)}_{p} &= e^{-i\gamma_{p} \varepsilon_{k}}\bar{F}_{p-1}^{(k)} - \frac{1}{N} (1-e^{-i\beta_{p}}) \left( \lvert G \rvert   F_{p-1} + \sum_{k'} \lvert E^{(k')} \rvert \bar{F}^{(k')}_{p-1} e^{-i\gamma_{p}\varepsilon_{k'}} \right) \,.
\end{align}

Pour résoudre le sous-problème, modifions le circuit original tel qu'illustré à la figure~\ref{fig:vqcount-circuit}. Pour chacun des derniers $q$ qubits:

\begin{enumerate}
    \item Remplacer la porte $H$ initial par une porte $X$ conditionnée par la valeur à laquelle le qubit est fixé.
    \item Enlever l'hamiltonien de forçage du qubit fixé.
\end{enumerate}

Nous trouvons par induction que l'état final après ces modifications suivent la même formule récursive que la formule~\ref{eq:recursive-formula} avec les transformations suivantes:

\begin{align*}
    \sum_{i=0}^{Q-1} \ket{i} &\to \ket{c} \,, \\
    N &\to N_{Q} \,, \\
    G &\to G_{c} \,, \\
    E^{(k)} &\to E^{(k)}_{c} \,,
\end{align*}

où $N_{Q} = 2^{n-q}$. L'état final conserve alors les mêmes propriétés que le circuit GM-QAOA initial.
\end{proof}

%-----------------------------------------------------------------------------%
