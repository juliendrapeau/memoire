\NeedsTeXFormat{LaTeX2e}[1995/12/01]
\ProvidesPackage{entete}[2015/09/15]

% Paquets de base
\usepackage[T1]{fontenc}                % Encodage des fontes
\usepackage[utf8]{inputenc}             % Encodage des caractères
\usepackage[greek, english, french]{babel} % Langues utilisées

% Paquets pour les unités et les mathématiques
\usepackage[squaren,Gray]{SIunits}      % Unités SI
\usepackage{amsmath}                    % Environnement mathématique
\usepackage{amssymb}                    % Symboles mathématiques
\usepackage{mathtools}                  % Améliorations de amsmath
\usepackage{bm}                         % Gras mathématique
\usepackage{upgreek}                    % Lettres grecques non-italiques

% Paquets pour les graphiques et les couleurs
\usepackage{graphicx}                   % Inclusion des images
\usepackage{color}                      % Gestion des couleurs
\usepackage[usenames,dvipsnames,svgnames,x11names]{xcolor} % Couleurs supplémentaires
\usepackage{tikz}                       % Dessins vectoriels
\usetikzlibrary{quantikz}               % Bibliothèque quantikz pour TikZ
\usetikzlibrary{external}               % Externalisation des dessins TikZ
\tikzset{external/force remake}         % Forcer la recréation des dessins TikZ
\tikzexternalize[prefix=tikz/]          % Externaliser les dessins TikZ

% Paquets pour les tableaux et les listes
\usepackage{multirow}                   % Cellules multi-lignes dans les tableaux
\usepackage{multicol}                   % Colonnes multiples
\usepackage{array}                      % Améliorations des tableaux
\usepackage{dcolumn}                    % Colonnes alignées sur les décimales
\usepackage[shortlabels]{enumitem}      % Listes avec labels courts

% Paquets pour les légendes et les flottants
\usepackage{subcaption}                 % Sous-légendes pour les figures
\usepackage{caption}                    % Gestion des légendes
\usepackage{float}                      % Gestion des flottants
\usepackage{placeins}                   % Gestion des flottants
\usepackage[bottom]{footmisc}           % Notes de bas de page en bas de page

% Paquets pour la typographie et la mise en page
\usepackage{microtype}                  % Amélioration de la typographie
\usepackage{geometry}                   % Gestion des marges (loadé dans switchboard)
\usepackage{setspace}                   % Gestion de l'interligne
\usepackage{pdflscape}                  % Pages en mode paysage

% Paquets pour les algorithmes et le code
\usepackage{listings}                   % Inclusion de listings de code
\usepackage[ruled,vlined]{algorithm2e}  % Algorithmes
\usepackage{algorithmic}                % Algorithmes

% Paquets pour la bibliographie et les citations
\usepackage[backend=biber, style=nature, doi=true, date=year, isbn=false]{biblatex} % Gestion de la bibliographie
\addbibresource{memoire.bib}            % Fichier de bibliographie
\usepackage{csquotes}                   % Gestion des citations

% Autres paquets divers
\usepackage{url}                        % Gestion des URLs
\usepackage{comment}                    % Gestion des commentaires
\usepackage{etoolbox}                   % Outils pour les toggles
\usepackage{kantlipsum}                 % Génération de texte bidon
\usepackage{xspace}                     % Gestion des espaces après les commandes
\usepackage{xstring}                    % Manipulation de chaînes de caractères
\usepackage{hyperref}                   % Hyperliens dans le document
\usepackage{braket}                     % Notation de Dirac
\usepackage{dsfont}                     % Fonte pour les ensembles
\usepackage{amsthm}                     % Environnements de théorèmes
\usepackage{epigraph}                   % Épigraphe

% Configuration des sous-légendes
\captionsetup[subfigure]{singlelinecheck=false} % Configuration des sous-légendes

% \definecolor{myblue}{rgb}{0.33725490196078434, 0.7058823529411765, 0.9137254901960784}
\definecolor{myblue}{rgb}{0.48137254901960785, 0.757843137254902, 0.9137254901960784}
\definecolor{mydarkblue}{HTML}{5278A3}
% \definecolor{myred}{rgb}{0.8666666666666667, 0.3607843137254902, 0.3607843137254902}
\definecolor{myred}{rgb}{0.8666666666666667, 0.4872549019607843, 0.4872549019607843}
\definecolor{mydarkred}{HTML}{DD5C5C}
% \definecolor{mysilver}{rgb}{0.7529411764755882, 0.7529411764755882, 0.7529411764755882}
\definecolor{mysilver}{rgb}{0.7529411764705882, 0.7529411764705882, 0.7529411764705882}
% \definecolor{myyellow}{rgb}{0.9411764705882353, 0.8941176470588236, 0.25882352941176473}
\definecolor{myyellow}{rgb}{0.9411764705882353, 0.9058823529411765, 0.4294117647058824}
\definecolor{mygreen}{rgb}{0.0, 0.6196078431372549, 0.4509803921568627}
\definecolor{mypink}{rgb}{0.8, 0.47450980392156855, 0.6549019607843136}
\definecolor{mybluedark}{rgb}{0.0, 0.44705882352941173, 0.6980392156862745}
\definecolor{myorange}{rgb}{0.9019607843137255, 0.6235294117647059, 0.0}
\definecolor{myviolet}{rgb}{0.3254901960784314, 0.1450980392156863, 0.4980392156862745}

\definecolor{mypurple}{HTML}{FFBB99}

% \newtheorem{theorem}{Théorème}[chapter]
% \newtheorem{corollary}{Corollaire}[theorem]
% \newtheorem{lemma}[theorem]{Lemme}
% \newtheorem*{remark}{Remarque}

% \theoremstyle{definition}
% \newtheorem{definition}{Définition}[chapter]


\usepackage[most]{tcolorbox}

\tcbset {
  base/.style={
    arc=1mm, 
    bottomtitle=0.5mm,
    boxrule=0mm,
    colback=black!5!white,
    colbacktitle=black!10!white, 
    coltitle=black, 
    fonttitle=\bfseries, 
    left=2.5mm,
    leftrule=1.5mm,
    right=3.5mm,
    title={#1},
    toptitle=0.75mm, 
  }
}  

\newtcbtheorem[auto counter,number within=chapter]{maintheorem}%
  {Théorème}{colframe=myblue, base={#1}, separator sign dash}{th}

\newtcbtheorem[use counter from=maintheorem,number within=chapter]{subtheorem}%
  {Théorème}{colframe=black!20!white, base={#1}, separator sign dash}{th}

\newtcbtheorem[auto counter,number within=chapter]{maindefinition}%
  {Définition}{colframe=myblue, base={#1}, separator sign dash}{def}

\newtcbtheorem[use counter from=maindefinition,number within=chapter]{subdefinition}%
  {Définition}{colframe=black!20!white, base={#1}, separator sign dash}{def}

\newtcbtheorem[auto counter,number within=chapter]{relation}%
  {Relation}{colframe=myblue, base={#1}, separator sign dash}{rel}

\newtcbtheorem[auto counter,number within=chapter]{corollary}%
   {Corollaire}{colframe=black!20!white, base={#1}, separator sign dash}{cor}

\newtcbtheorem[auto counter,number within=chapter]{lemma}%
   {Lemme}{colframe=black!20!white, base={#1}, separator sign dash}{lem}

\newtcbtheorem[auto counter,number within=chapter]{remark}%
   {Remarque}{colframe=black!20!white, base={#1}, separator sign dash}{rem}

\newtcbtheorem[auto counter,number within=chapter]{example}%
   {Exemple}{colframe=black!20!white, base={#1}, separator sign dash}{ex}


%=============================================================================%

% Columns centered on a decimal position
\newcolumntype{.}{D{.}{.}{-1}}
%Ajoute un style de colonne centrées verticalement
%\newcolumntype{V}{>{\centering\arraybackslash} m{.15\linewidth} }
%\newcolumntype{v}{>{\centering\arraybackslash} m{.08\linewidth} }

%=============================================================================%

% Mise en page française
\addto\captionsfrench{\def\figurename{{\sc Figure}}}
\addto\captionsfrench{\def\tablename{{\sc Tableau}}}
\addto\captionsfrench{\def\listfigurename{Liste des figures}}

%=============================================================================%

% Formatage du document.

% Indentation et espacement
\setlength{\parindent}{4ex}
\setlength{\parskip}{2ex plus 0.5ex minus 0.2ex}

% Header/Footer plus propres
\usepackage[plainheadsepline,nouppercase]{scrlayer-scrpage}
\pagestyle{scrheadings}
%\renewcommand{\chaptermark}[1]{\markboth{{\thechapter. #1}}{}}
%\renewcommand{\sectionmark}[1]{}}

% Apparence des chapitres/(sous(-sous)-)sections.
\newcommand\chapterstring{Chapitre}
\usepackage{titlesec}
% Fix for titlesec 2.10.1, doesn't change anything for 2.10.2+ (a priori)
\makeatletter
\patchcmd{\ttlh@hang}{\parindent\z@}{\parindent\z@\leavevmode}{}{}
\patchcmd{\ttlh@hang}{\noindent}{}{}{}
\makeatother
% chapitres
\titleformat{\chapter}[display] {\bfseries\color{black}} {\filright
\enspace \Large \chapterstring~\thechapter} {14pt} {\Huge\filcenter}
% sections
\titleformat{\section}{\vspace{0mm plus 2cm}\addpenalty{-1000}\Large\bfseries}{\thesection}{1em}{}
% sous-sections
\titleformat{\subsection}{\addpenalty{-500}\large\bfseries}{\thesubsection}{1em}{} 
% sous-sous-sections
\titleformat{\subsubsection}{\penalty-500\vspace{0pt plus 2pt}{}\bfseries}{\thesubsubsection}{}{}[\vspace{-14pt}]


% Séquestres les Floats à la section courante.
% Évite d'avoir une image dans la section après celle définie.
\let\oldsection\section
\renewcommand{\section}[1]{\FloatBarrier\oldsection{#1}\FloatBarrier}

%% Idem pour les sous-section, mais pas tjrs jolie pour petite sous-section.
%\let\oldsubsection\subsection
%\renewcommand{\subsection}[1]{\FloatBarrier\oldsubsection{#1}\FloatBarrier}

%=============================================================================%


%% Minted listings style
%% Jolie listing de code, e.g. \inputminted{pyhton}{test.py}
%\renewcommand{\theFancyVerbLine}{
%  \ttfamily\textcolor[rgb]{0.5,0.5,0.5}{\tiny\arabic{FancyVerbLine}}}
%\usemintedstyle{default}


%=============================================================================%
% On ré-implémente les commandes utilisées pour générer les tables/listes et la 
% bibliographie dans le but d'avoir les bons numéros de pages dans les 
% bookmarks pdf et la table des matière.

% Redefining the way TOC/LOF/LOT/BIB are built to have right pdfbookmark page.
\renewcommand{\tableofcontents}
             {
                \clearpage
                \chapter*{\pdfbookmark[chapter]{\contentsname}{toc}
                          \contentsname}
                \csname @starttoc\endcsname{toc}
             }

\renewcommand{\listoffigures}
             {
                \clearpage
                \chapter*{\pdfbookmark[chapter]{\listfigurename}{lof}
                          \listfigurename}
                \csname @starttoc\endcsname{lof}
             }

\renewcommand{\listoftables}
             {
                \clearpage
                \chapter*{\pdfbookmark[chapter]{\listtablename}{lot}
                          \listtablename}
                \csname @starttoc\endcsname{lot}
             }

\let\oldbibliography\bibliography
\renewcommand{\bibliography}[1]
             { 
                \clearpage
                \chapter*{\bibname}
                \bibpagestyle   % Gère les entêtes de la bibliographie
                \addcontentsline{toc}{chapter}{\bibname}
                \begingroup
                    \renewcommand{\chapter}[2]{}
                    \oldbibliography{#1}
                \endgroup
             }

%=============================================================================%

% Pour définir certaines métadonnées
\newcommand{\Organisation}[1]{\renewcommand{\Organisation}{#1}}
\newcommand{\Location}[1]{\renewcommand{\Location}{#1}}
\newcommand{\ResumeCourt}[1]{\renewcommand{\ResumeCourt}{#1}}
\newcommand{\MotsClefs}[1]{\renewcommand{\MotsClefs}{#1}}

%=============================================================================%
